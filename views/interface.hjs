<!doctype html>
<html lang="en">
    <head>
        <title>{{ title }}</title>
    </head>
    <body>
        <h1>Rehabilitate</h1>
		<a href="/">Back</a>
        
		<!-- error message-->
		{{#message}}
      		<p>{{message}}<p>
    	{{/message}}
		
		<div id="start">
            Start
        </div>
        <div id="stop">
            Stop
        </div>
		<div>
			<p class="sets"></p>
			<br>
			<p class= "reps"></p>
		</div>
		<form action='/twilio' method='post'>
			<input type='submit' value="Text!">
		</form>
  
         <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script src="js/myo.js"></script>
        <script>
           $(document).ready(function() {
				var myMyo = Myo.create();
				myMyo.unlock();
				var bool = true;
				var record = false;
				var final = [];
				var accFinal = [];

				var count = 0;
				var count_sets = {{sets}} ;
				var count_reps = {{ reps }} ;

			   	$( ".sets").text(count_sets);
			   	$( ".reps").text(count_reps);

				$( "#start" ).click(function() {
					record = true;
					alert("strt");
				});
			   

				$( "#stop" ).click(function() {
					record = false;
					alert("stop");
					//var res = $.csv.fromArrays(final);
					//console.log(res);
					var resAcc = $.csv.fromArrays(accFinal);
					console.log("ACCELERATION");
					console.log(resAcc);
				});	

				

				myMyo.on('pose', function(pose_name, edge) {
            	  if (pose_name != 'rest' && edge) {
          	      console.log('Started ', pose_name);
          	    	}

          	 	   if (pose_name == 'wave_in' && edge) {
           	  	   	console.log('good job (wave in)! ');

           	  	   if (count == 0) {
           	  	   	count = 1;
           	  	   }

           	  	   if (count == 2) {
           	  	   		count = 0;
           	  	   		count_reps = count_reps - 1;
           	  	   		$( ".reps").text(count_reps);
           	  		}

           	  		if (count_reps == 0) {
           	  			count_reps = {{reps}};
           	  			$( ".reps").text(count_reps);
           	  			count_sets = count_sets - 1;
           	  			$( ".sets").text(count_sets);
           	  		}

           	  		if (count_sets == 0) {
           	  			alert ("ANNDD YOUU AREEE THE CHAMMPIOOONN");
           	  		}

            	  }
            		if (pose_name == 'wave_out' && edge) {
             	   		console.log('good job (wave out)!');
             	   		if (count == 0) {
           	  	   			count = 2;
           	  	   		}

           	  	  	 	if (count == 1) {
           	  	  		 count = 0;
           	  	   			count_reps = count_reps - 1;
           	  	   			$( ".reps").text(count_reps);
           	  			}

           	  			if (count_reps == 0) {
           	  				count_reps = {{reps}};
           	  				$( ".reps").text(count_reps);
           	  				count_sets = count_sets - 1;
           	  				$( ".sets").text(count_sets);
           	  			}

           	  			if (count_sets == 0) {
           	  				alert ("ANNDD YOUU AREEE THE CHAMMPIOOONN");
           	  			}
             		 }
           		 });
				/*
				myMyo.on('accelerometer', function(data){
					//console.log("acc");
					  if (record) {
						  var ax = data.x;
						  var ay = data.y;
						  var az = data.z;

						  // calculate data
						  var acc = [ax, ay, az];
						  accFinal.push(acc);
						  //console.log(result);
					  }
				});
<<<<<<< HEAD
				*/
=======

		    myMyo.on('lock', function(){
                myMyo.unlock();
            });
            
            myMyo.on('pose', function(pose_name, edge) {
              if (pose_name != 'rest' && edge) {
                console.log('Started ', pose_name);
              }
              if (pose_name == 'wave_in' && edge) {
                alert('good job (wave in)! ');
              }
              if (pose_name == 'wave_out' && edge) {
                alert('good job (wave out)!');
              }
            });

>>>>>>> 51719729bf7130b114e03bc642bd50bd331d7dc3
            });
        </script>
    </body>
</html>
